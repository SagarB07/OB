<?xml version="1.0"?>
  <database name="VIEW CO_RETENCION_VENTA_V">
    <view name="CO_RETENCION_VENTA_V"><![CDATA[SELECT i.c_invoice_id AS co_retencion_venta_v_id, i.ad_client_id, i.ad_org_id, i.isactive, i.created, i.createdby, i.updated, i.updatedby, sr.c_bpartner_id AS salesrep_id, bp.c_bpartner_id, i.documentno, i.dateinvoiced, i.dateacct, i.grandtotal, i.totallines, (SELECT COALESCE(sum(it.taxamt), 0) AS "coalesce" FROM c_invoicelinetax it WHERE i.c_invoice_id = it.c_invoice_id) AS taxamt, rv.documentno AS no_retencion, (SELECT COALESCE(sum(rvl.valor_retencion), 0) AS "coalesce" FROM co_retencion_venta_linea rvl WHERE rvl.tipo = 'FUENTE' AND rvl.co_retencion_venta_id = rv.co_retencion_venta_id) AS fuente, (SELECT COALESCE(sum(rvl.valor_retencion), 0) AS "coalesce" FROM co_retencion_venta_linea rvl WHERE rvl.tipo = 'IVA' AND rvl.co_retencion_venta_id = rv.co_retencion_venta_id) AS iva, COALESCE(rv.total_retencion, 0) AS total_retencion FROM c_invoice i JOIN c_bpartner bp ON i.c_bpartner_id = bp.c_bpartner_id LEFT JOIN c_bpartner sr ON i.salesrep_id = sr.c_bpartner_id LEFT JOIN co_retencion_venta rv ON i.c_invoice_id = rv.c_invoice_id AND rv.docstatus = 'CO' AND rv.isactive = 'Y' AND rv.processed = 'Y' WHERE i.issotrx = 'Y']]></view>
  </database>
